# Пользователи и группы. Авторизация и аутентификация 
**Домашнее задание**  
- Запретить всем пользователям, кроме группы admin логин в выходные (суббота и воскресенье), без учета праздников.
- дать конкретному пользователю права работать с докером и возможность рестартить докер сервис.

---
1. С помощью Vagrant поднимем стендовую виртуальную машину с Сentos7  
2. Создадим пользователя:  
`useradd ironman`  
3. Создадим группу:  
`groupadd admin`
4. Добавим пользователя в группу:  
`usermod -aG admin ironman`
5. Обновим репозитарий:  
`yum install -y epel-release`  
6. Устанавливим компонент, с помощью которого сможем описывать правила входа в виде bash-скрипта:  
`yum install pam_script -y`
7. Можно посмотреть какие файлы использует этот компонент:  
`rpm -ql pam_script`
8. Теперь, в файле /etc/pam.d/sshd первой строкой добавим:  
> auth required pam_script.so  
> ...

9. Далее приводим файл /etc/pam_script к следующему виду (у файла должны быть права на исполнение):  
> #!/bin/bash  
> if [[ \`grep $PAM_USER /etc/group | grep 'admin'` ]]  
> then  
> exit 0  
> fi  
> if [[ `date +%u` > 5 ]]  
> then  
> exit 1  
> fi  

В этом файле мы проверяем состоит ли пользователь в группе admin и если да то пускаем его (значит его можно пускать всегда). Если он не состоит в этой группе то срабатывает проверка на то, какой сейчас день недели, если он больше 5, т.е. выходные то не пускаем.  

10. Теперь добавим пользователя в sudoers, чтобы он мог выполнять команды от имени root.  
`usermod -aG wheel ironman`
